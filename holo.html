<!DOCTYPE html>
<html>

	<head>
		<title>Tile Tessellator</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">

		<link rel="stylesheet" href="css/shared.css"/>

		<script type="text/javascript" src="src/jquery-1.11.3.min.js"></script>
		<script type="text/javascript" src="src/three.min.js"></script>
		<script type="text/javascript" src="src/OrbitControls.js"></script>
		<script type="text/javascript" src="src/Detector.js"></script>
		<script type="text/javascript" src="src/OBJLoader.js"></script>
		<script type="text/javascript" src="src/TGALoader.js"></script>
		<script type="text/javascript" src="src/OBJExporter.js"></script>
		<script type="text/javascript" src="assets/terrain-meta.js"></script>

		<script type="text/javascript" src="js/EngineRenderer.js"></script>
	</head>
	<body>

		<div id="container"></div>

		<script>
$(document).ready(function(){
	init();
});

var holo;
var cursor;

function init() {
	container = document.getElementById('container');
	
	holo = new EngineRenderer(container, true, false, false);
	holo.init();
	holo.render();
	
	var fenceTex = THREE.ImageUtils.loadTexture( 'assets/holograms/hologram_fence_RGB.png' );
	fenceTex.magFilter = THREE.NearestFilter;
	fenceTex.minFilter = THREE.LinearMipMapLinearFilter;
	
	var iconTex = THREE.ImageUtils.loadTexture( 'assets/holograms/hologram_icon_white.png' );
	iconTex.magFilter = THREE.NearestFilter;
	iconTex.minFilter = THREE.LinearMipMapLinearFilter;
	
	var wallTex = THREE.ImageUtils.loadTexture( 'assets/holograms/hologram_wall_RGBA.png' );
	wallTex.magFilter = THREE.NearestFilter;
	wallTex.minFilter = THREE.LinearMipMapLinearFilter;
	/*
	holo.objLoader.load( "assets/holograms/hologram_icon_tv_white.obj", function(object){
		object.traverse( function( child ) {
			if ( child instanceof THREE.Mesh ) {
				var myMesh = child;
				myMesh.material.map = iconTex;
				myMesh.material.needsUpdate = true;
			}
		});
		object.scale.set(0.001, 0.001, 0.001);
		object.position.y = 2.5;
		holo.scene.add(object);
	});
	*/
	holo.objLoader.load( "assets/holograms/hologram_icon_crosshair_white.obj", function(object){
		object.traverse( function( child ) {
			if ( child instanceof THREE.Mesh ) {
				var myMesh = child;
				myMesh.material.map = iconTex;
				myMesh.material.needsUpdate = true;
			}
		});
		object.scale.set(0.0001, 0.0001, 0.0001);
		object.position.y = 2.5;
		holo.scene.add(object);
	});
	
	holo.objLoader.load( "assets/holograms/hologram_frame_small_tv.obj", function(object){
		object.traverse( function( child ) {
			if ( child instanceof THREE.Mesh ) {
				var myMesh = child;
				myMesh.material.map = wallTex;
				myMesh.material.transparent = true;
				myMesh.material.needsUpdate = true;
			}
		});
		object.scale.set(0.1, 0.1, 0.1);
		object.position.y = 2.5;
		object.position.z = 0;
		holo.scene.add(object);
	});
	/*
	holo.objLoader.load( "assets/holograms/hologram_icon_cursor_white.obj", function(object){
		cursor = object;
		cursor.traverse( function( child ) {
			if ( child instanceof THREE.Mesh ) {
				var myMesh = child;
				myMesh.material.map = iconTex;
				myMesh.material.needsUpdate = true;
			}
		});
		cursor.scale.set(0.0002, 0.0002, 0.0002);
		cursor.position.x = 2;
		cursor.position.y = 5.25;
		cursor.position.z = 0;
		holo.scene.add(object);
	});
	*/
	holo.light.position.set(-2, 20, -2);
	
	animate();
}

var up = 0;
var upSwitch = true;

function animate() {
	requestAnimationFrame(animate);
	cursor.rotation.y = cursor.rotation.y + 0.05;
	if(up <= 0){
		upSwitch = true;
	}
	if(up >= 60){
		upSwitch = false;
	}
	if(upSwitch){
		up++;
		cursor.position.y = cursor.position.y + 0.001;
	}
	if(!upSwitch){
		up--;
		cursor.position.y = cursor.position.y - 0.001;
	}
}

		</script>
		
	</body>
</html>

